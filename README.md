# 技术文档

**项目名：**躲避病毒？

**使用引擎：**Unity

**引擎版本：**2020.3.41f1c1 LTS

## 玩家移动

采用了Unity的新Input System系统使其同时适配PC与安卓

在Input System中建立了Position与Act两个Action

当玩家点击鼠标左键即会触发Act的回调函数，玩家拖动鼠标则会触发Position的回调函数

Position与Act的回调函数都包含一个bool变量

**状态1：**鼠标左键未被按下时，bool值为false，此时Position的回调函数不对鼠标位置进行监听

**状态2：**鼠标左键被按下时，bool值被设置为true，Position的回调函数开始监听并返回鼠标坐标，同时获取玩家坐标，这两个向量相减即可获得速度向量，使玩家向速度向量方向移动即可实现”拖拽“效果

**状态3：**鼠标左键被抬起，bool值被重新设置为false，回到状态1

## 其余动态精灵管理

游戏中除玩家外其余动态精灵全部继承自一个Element基类

Element基类实现了获取玩家当前位置，并向玩家位置飞去的功能

同时提供了Speed与Damage两个接口，分别用于设置精灵的速度和与玩家发生碰撞时造成的伤害

## UI层与数据管理

UI层中计时器“TimeManager”因效果较为特殊，故单独写了个类，采取协程方法进行计时

其余UI层参考了MVC架构，通过一个不继承Mono的单例类GameModel来存储管理游戏中的“life、score”等数据，当数据变动时，通过事件中心通知UI层进行数据更新

## 动态精灵的随机生成

游戏中有着随机位置生成随机精灵的需求，故创建了空父物体“Elements”，用其挂载的“ElementGenerator”来管理生成其余精灵

将其余精灵保存为预制体后，采取了list来存放精灵，后通过Random随机生成即可